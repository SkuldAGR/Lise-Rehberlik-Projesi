// asamalar.js - global script (no module)
const asamalar = {
  "D": {
    "Müşavirlik": {
      "DMÖ - Öğretmene Yönelik": [
        "DMÖG - Aile",
        "DMÖG - Akademik Konular",
        "DMÖG - Okula ve Çevreye Uyum",
        "DMÖG - Problem Davranış",
        "DMÖG - Psikolojik Uyum",
        "DMÖG - Sağlık",
        "DMÖG - Sevk Bilgilendirme",
        "DMÖG - Sosyal Uyum",
        "DMÖG - Sosyoekonomik Konular",
        "DMÖG - Yöneltme Yerleştirme"
      ],
      "DMV - Veliye yönelik": [
        "DMVG - Aile",
        "DMVG - Akademik Konular",
        "DMVG - Danışmanlık Tedbiri",
        "DMVG - Okula ve Çevreye Uyum",
        "DMVG - Problem Davranış",
        "DMVG - Psikolojik Uyum",
        "DMVG - Sağlık",
        "DMVG - Sevk Bilgilendirme",
        "DMVG - Sosyal Uyum",
        "DMVG - Sosyoekonomik Konular",
        "DMVG - Yöneltme Yerleştirme"
      ]
    }
  },
  "İ": {
    "İB - Bireysel Psikolojik Danışma": {
      "İB - Aile": [],
      "İB - Davranış Sorunları": [],
      "İB - OBM": [],
      "İB - Okul öncesi - Arkadaşlık İlişkileri Geliştirme Psikoeğitim Programı (Zorba)": [],
      "İB - Okul öncesi - Arkadaşlık İlişkileri Geliştirme Psikoeğitim Programı (Maruz Kalan)": [],
      "İB - Psikolojik Uyum": [],
      "İB - Sağlık": [],
      "İB - Sosyal Uyum": [],
      "İB - Sosyoekonomik Konular": [],
      "İB - Travma Sonrası Grup Temelli Müdahale Programı (TS-GTM)": [],
      "İB - Yöneltme Yerleştirme": []
    },
    "İP - Psikososyal Müdahale": {
      "İPbB - Bildirim Yükümlülüğü": [
        "İPbB - Cinsel İstismar",
        "İPbB - Duygusal İhmal",
        "İPbB - Duygusal İstismar",
        "İPbB - Eğitim İle İlgili İhmal",
        "İPbB - Ekonomik İstismar",
        "İPbB - Fiziksel İhmal",
        "İPbB - Fiziksel İstismar",
        "İPbB - Madde Bulundurma",
        "İPbB - Madde Kullanımı",
        "İPbB - Madde Satışı",
        "İPbB - Sağlık İhmali"
      ],
      "İPbİ - İntihar": [
        "İPbİ - Tamamlanmamış İntihar",
        "İPbİ - Tamamlanmış İntihar"
      ],
      "İPbT - Koruyucu ve Destekleyici Tedbir": [
        "İPbT - Danışmanlık Tedbiri",
        "İPbT - Danışmanlık ve Eğitim Tedbiri",
        "İPbT - Eğitim Tedbiri"
      ]
    },
    "İS - Sevk (Yönlendirme)": {
      "İS - Diğer": [],
      "İS - RAM Rehberlik ve Psikolojik Danışma Hizmetleri Bölümüne Yönlendirme": [],
      "İS - Sağlık Kuruluşuna Yönlendirme": []
    }
  },
  "Ö": {
    "ÖOB - Bireyi Tanıma Çalışmaları": {
        "B.K.P.1.c - Yaşam Pencerem": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.G.4.c - Öğrenci Bilgi Formu": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.G.12.c - Yol Haritam": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.O.1.c - Bana Kendini Anlat": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.G.3.c - Kendimi Taniyorum": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.A.7.c - Siddet Algısı Anketi": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.A.8.c - Siddet Sıklığı Anketi": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.A.9.c - Siddet Meşruiyeti Anketi": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.A.10.c - Siddet Algısı Anketi (Veli)": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.G.G.10.c - Siddet Sıklığı Anketi (Veli)": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.A.12.c - Siddet Meşruiyeti Anketi (Veli)": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.A.11.c - Siddet Algisi Anketi (Ögretmen)": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.G.G.11.c - Siddet Sıklığı Anketi (Ögretmen)": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.A.13.c - Siddet Meşruiyeti Anketi (Ögretmen 4-6. Sınıf)": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.A.14.c - Siddet Meşruiyeti Anketi (Ögretmen 7-12. Sınıf)": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.I.1.c - Verimli Ders Calisma Kontrol Listesi": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.G.G.2.c - Çocuğumu Tanıyorum Formu": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.G.G.1.c - Aile içi Gözlem Formu": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.G.G.3.c - DEHB Gözlem Formu": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.G.G.4.0 - Ev Ziyaret Formu": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.G.G.7.c - Ögrenci Gözlem Kaydı": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.G.G.8.a - Özel Ögrenme Günlüğü Gözlem Formu": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.G.7.c - Ögrenci-Öngörüşme Formu": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "B.K.A.2.C - Devamsızlık Nedenleri Anketi": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "RAM (LEITER) - RAM (LEITER)": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "RAM (ASIS) - RAM (ASIS)": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "RAM (S.BINET) - RAM (S.BINET)": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "RAM (ÖGT) - RAM (ÖGT)": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "RAM (WISC-R) - RAM (WISC-R)": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"],
        "ÖOB99 - Diğer": ["Geri Bildirim", "Sonuç Değerlendirme", "Uygulama"]
    },
    "ÖDY - Yöneltme Ve İzleme": {
      "ÖOYb - Alan/Dal Tercihleri": [],
      "ÖOYb - Değişen Ben-Sosyal Kültürel Faaliyetleri": [],
      "ÖOYb - Risk Haritası-Sosyal Kültürel Faaliyetler": [],
      "ÖOYb - Seçmeli Ders": [],
      "ÖOYb - Sosyal Klüpler": [],
      "ÖOYb - Üst Öğrenim Kurumuna Geçen Öğrencilerin İzlenmesi": []
    }
  }
};

// form.js içinde kullanılan fonksiyon tanımları
function rdpSecildi(hizmet) {
  window.seciliHizmet = hizmet;
  const birinciAsamaSelect = document.querySelector("select[name='birinciasama']");
  const ikinciAsamaSelect = document.querySelector("select[name='ikinciasama']");
  const ucuncuAsamaSelect = document.querySelector("select[name='ucuncuasama']");

  [birinciAsamaSelect, ikinciAsamaSelect, ucuncuAsamaSelect].forEach(sel => {
    sel.innerHTML = '<option value="">Seçiniz</option>';
    sel.disabled = true;
  });

  if (asamalar[hizmet]) {
    Object.keys(asamalar[hizmet]).forEach(key => {
      const option = document.createElement("option");
      option.value = key;
      option.textContent = key;
      birinciAsamaSelect.appendChild(option);
    });
    birinciAsamaSelect.disabled = false;
  }
}

function birinciAsamaSecildi(birinci) {
  const ikinciAsamaSelect = document.querySelector("select[name='ikinciasama']");
  const ucuncuAsamaSelect = document.querySelector("select[name='ucuncuasama']");

  [ikinciAsamaSelect, ucuncuAsamaSelect].forEach(sel => {
    sel.innerHTML = '<option value="">Seçiniz</option>';
    sel.disabled = true;
  });

  const list = asamalar[window.seciliHizmet]?.[birinci];
  if (list && typeof list === 'object') {
    const keys = Array.isArray(list) ? list : Object.keys(list);
    keys.forEach(item => {
      const option = document.createElement("option");
      option.value = item;
      option.textContent = item;
      ikinciAsamaSelect.appendChild(option);
    });
    ikinciAsamaSelect.disabled = false;
  }
}

function ikinciAsamaSecildi(ikinci) {
  const ucuncuAsamaSelect = document.querySelector("select[name='ucuncuasama']");
  ucuncuAsamaSelect.innerHTML = '<option value="">Seçiniz</option>';
  ucuncuAsamaSelect.disabled = true;

  const birinci = document.querySelector("select[name='birinciasama']").value;
  const list = asamalar[window.seciliHizmet]?.[birinci]?.[ikinci];
  if (Array.isArray(list)) {
    list.forEach(item => {
      const option = document.createElement("option");
      option.value = item;
      option.textContent = item;
      ucuncuAsamaSelect.appendChild(option);
    });
    ucuncuAsamaSelect.disabled = false;
  }
}

// Fonksiyonları global yap
window.rdpSecildi = rdpSecildi;
window.birinciAsamaSecildi = birinciAsamaSecildi;
window.ikinciAsamaSecildi = ikinciAsamaSecildi;
